from selenium import webdriver
import time
import keyboard
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support.ui import Select
import random
import string
import datetime

link = 'https://bnkmsc-1032-front-bank-deposit.okd.t-global.bcs/evaDeposit'

print("start browser for test...")
chrome_options = Options()
#chrome_options.add_argument("--headless")
chrome_options.add_experimental_option("useAutomationExtension", False)
browser = webdriver.Chrome(options=chrome_options)
browser.get(link)
browser.implicitly_wait(3)
time.sleep(1.5)
keyboard.press_and_release('enter')
browser.find_element_by_css_selector('#username').send_keys('KuzmenkoNV')
browser.find_element_by_css_selector('#password').send_keys('122fea1ac9A')
browser.find_element_by_css_selector('#kc-login').click()
time.sleep(2)


def rnd_str():
    rnd_lenght = 20
    return ''.join([random.choice(string.ascii_letters + string.digits + string.punctuation) for n in range(rnd_lenght)])

def rnd_uni():
    return str(random.uniform(-10000000, 10000000))

def rnd_int():
    return str(random.randint(0,10000000000000))

number_of_entities = 4

for i in range(number_of_entities):

    browser.find_element_by_css_selector('.btn-success').click()  # Нажать кнопку "Добавить"
    #Наименование вида депозита
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Наименование вида депозита']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Наименование вида депозита']")).select_by_index(randomNumber)

    #Код депозита
    browser.find_element_by_xpath("//input[@placeholder='Код депозита']").send_keys(rnd_str())

    #Категория
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Категория']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Категория']")).select_by_index(randomNumber)

    #Наименование депозита
    browser.find_element_by_xpath("//input[@placeholder='Наименование депозита']").send_keys(rnd_str())

    #Статус ЕВА
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Статус ЕВА']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Статус ЕВА']")).select_by_index(randomNumber)

    #Периодичность начисления процентов
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Периодичность начисления процентов']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Периодичность начисления процентов']")).select_by_index(randomNumber)

    #Минимальная сумма
    browser.find_element_by_xpath("(//input[@placeholder='Минимальная сумма'])[1]").send_keys(rnd_uni())

    #Максимальная сумма
    browser.find_element_by_xpath("(//input[@placeholder='Максимальная сумма'])[1]").send_keys(rnd_uni())

    #Тип срока
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Тип срока']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Тип срока']")).select_by_index(randomNumber)

    #Срок зачисления
    browser.find_element_by_xpath("//input[@placeholder='Срок зачисления']").send_keys(random.randint(0, 100000))

    #Вид значений
    dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='Вид значений']/option[@value]")
    randomNumber = random.randint(1, len(dropdown_size)) #рандомизация индекса для выбора из dropdown
    Select(browser.find_element_by_xpath("//select[@placeholder='Вид значений']")).select_by_index(randomNumber)

    #Минимальный срок
    browser.find_element_by_xpath("//input[@placeholder='Минимальный срок']").send_keys(random.randint(0, 100000))

    #Максимальный срок
    browser.find_element_by_xpath("//input[@placeholder='Максимальный срок']").send_keys(random.randint(0, 100000))

    #Обязательные чекбоксы
    browser.find_element_by_xpath("(//input[@type='checkbox'])[8]").click()
    browser.find_element_by_xpath("(//input[@type='checkbox'])[9]").click()
    browser.find_element_by_xpath("(//input[@type='checkbox'])[10]").click()
    browser.find_element_by_xpath("(//input[@type='checkbox'])[11]").click()
    browser.find_element_by_xpath("(//input[@type='checkbox'])[12]").click()

    #Инветор
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[1]").click()

    #Капитализация
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[2]").click()

    #До востребования
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[3]").click()

    #Комбинированный
    if random.randint(0, 2):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[4]").click()
        # Пропорция вложения
        num1 = random.randint(0, 100)
        num2 = 100 - num1
        browser.find_element_by_xpath("//input[@placeholder='Пропорция вложения в депозит']").send_keys(str(num1))
        browser.find_element_by_xpath("//input[@placeholder='Пропорция вложения в ПИФ']").send_keys(str(num2))

    #Закрытие из ЕВА
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[5]").click()

    #Мультивалютный
    # if random.randint(0, 1):
    #     browser.find_element_by_xpath("(//input[@type='checkbox'])[6]").click()
    #     browser.find_element_by_xpath("//input[@placeholder='Совокупная сумма мультивалютного депозита.']").send_keys(rnd_uni())

    #С депозита
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[7]").click()

    #Список сумм по ККО
    if random.randint(0, 1):
        browser.find_element_by_xpath("(//input[@type='checkbox'])[13]").click()

        dropdown_size = browser.find_elements_by_xpath("//select[@placeholder='ККО']/option[@value]")
        randomNumber = random.randint(1, len(dropdown_size))  # рандомизация индекса для выбора из dropdown
        Select(browser.find_element_by_xpath("//select[@placeholder='ККО']")).select_by_index(randomNumber)

        browser.find_element_by_xpath("(//input[@placeholder='Минимальная сумма'])[2]").send_keys(rnd_uni())
        browser.find_element_by_xpath("(//input[@placeholder='Максимальная сумма'])[2]").send_keys(rnd_uni())

    #СОХРАНИТЬ
    #time.sleep(10)
    browser.find_element_by_css_selector('.btn-primary').click()

print ("finish")

#time.sleep(15)    #debug wait time to see the result
#browser.quit()
